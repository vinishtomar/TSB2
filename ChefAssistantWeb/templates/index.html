
     <!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi de Chantier</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .rounded-card {
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card-title {
            font-weight: bold;
            color: #2c3e50;
        }
        .nav-tabs .nav-link.active {
            background-color: #f8f9fa;
            border-bottom: 3px solid #007bff;
        }
        .form-label {
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-light">
    <!-- Last modified metadata -->
    <input type="hidden" name="last_modified" value="2025-06-03 14:42:28">
    <input type="hidden" name="last_modified_by" value="tsbenergie">

    <div class="container-fluid py-4">
        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="equipement-tab" data-bs-toggle="tab" 
                        data-bs-target="#equipement" type="button" role="tab" 
                        aria-controls="equipement" aria-selected="true">
                    Équipement
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="connecteur-tab" data-bs-toggle="tab" 
                        data-bs-target="#connecteur" type="button" role="tab" 
                        aria-controls="connecteur" aria-selected="false">
                    Connecteur
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="chemincable-tab" data-bs-toggle="tab" 
                        data-bs-target="#chemincable" type="button" role="tab" 
                        aria-controls="chemincable" aria-selected="false">
                    Chemin de câble
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="terre-tab" data-bs-toggle="tab" 
                        data-bs-target="#terre" type="button" role="tab" 
                        aria-controls="terre" aria-selected="false">
                    Terre
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="cable-ac-tab" data-bs-toggle="tab" 
                        data-bs-target="#cable-ac" type="button" role="tab" 
                        aria-controls="cable-ac" aria-selected="false">
                    Câble AC
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="cable-dc-tab" data-bs-toggle="tab" 
                        data-bs-target="#cable-dc" type="button" role="tab" 
                        aria-controls="cable-dc" aria-selected="false">
                    Câble DC
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="avancement-tab" data-bs-toggle="tab" 
                        data-bs-target="#avancement" type="button" role="tab" 
                        aria-controls="avancement" aria-selected="false">
                    Avancement
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="fin-tab" data-bs-toggle="tab" 
                        data-bs-target="#fin" type="button" role="tab" 
                        aria-controls="fin" aria-selected="false">
                    Fin
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="historique-tab" data-bs-toggle="tab" 
                        data-bs-target="#historique" type="button" role="tab" 
                        aria-controls="historique" aria-selected="false">
                    Historique
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="myTabContent">
                        <!-- Equipment Tab -->
            <div class="tab-pane fade show active" id="equipement" role="tabpanel" aria-labelledby="equipement-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi des Équipements</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="equipement">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:44:06">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Type de Machine</label>
                                    <select class="form-select" name="equipement_type" required>
                                        <option value="">Sélectionner un type</option>
                                        <option value="Onduleur">Onduleur</option>
                                        <option value="Transformateur">Transformateur</option>
                                        <option value="Panneau">Panneau</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner un type</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Référence</label>
                                    <input type="text" class="form-control" name="equipement_reference" required>
                                    <div class="invalid-feedback">Veuillez entrer une référence</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">État</label>
                                    <select class="form-select" name="equipement_etat" required>
                                        <option value="">Sélectionner un état</option>
                                        <option value="Neuf">Neuf</option>
                                        <option value="Bon">Bon</option>
                                        <option value="Moyen">Moyen</option>
                                        <option value="Mauvais">Mauvais</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner un état</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Date de Réception</label>
                                    <input type="date" class="form-control" name="equipement_date_reception" required>
                                    <div class="invalid-feedback">Veuillez sélectionner une date</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Nombre</label>
                                    <input type="number" class="form-control" name="equipement_nombre" required min="1">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_equipement" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
                        <!-- Connector Tab -->
            <div class="tab-pane fade" id="connecteur" role="tabpanel" aria-labelledby="connecteur-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi des Connecteurs</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="connecteur">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:45:30">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Type de Connecteur</label>
                                    <select class="form-select" name="connecteur_type" required>
                                        <option value="">Sélectionner un type</option>
                                        <option value="MC4">MC4</option>
                                        <option value="MC4-EVO2">MC4-EVO2</option>
                                        <option value="T4">T4</option>
                                        <option value="Sunclix">Sunclix</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner un type</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Quantité</label>
                                    <input type="number" class="form-control" name="connecteur_quantite" required min="1">
                                    <div class="invalid-feedback">Veuillez entrer une quantité valide</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">État</label>
                                    <select class="form-select" name="connecteur_etat" required>
                                        <option value="">Sélectionner un état</option>
                                        <option value="Neuf">Neuf</option>
                                        <option value="Bon">Bon</option>
                                        <option value="Moyen">Moyen</option>
                                        <option value="Mauvais">Mauvais</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner un état</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_connecteur" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Cable Path Tab -->
            <div class="tab-pane fade" id="chemincable" role="tabpanel" aria-labelledby="chemincable-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi des Chemins de Câbles</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="chemincable">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:45:30">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Longueur (mètres)</label>
                                    <input type="number" class="form-control" name="chemin_cable_longueur" required step="0.1" min="0">
                                    <div class="invalid-feedback">Veuillez entrer une longueur valide</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Type</label>
                                    <select class="form-select" name="chemin_cable_type" required>
                                        <option value="">Sélectionner un type</option>
                                        <option value="Dalle">Dalle</option>
                                        <option value="Grillage">Grillage</option>
                                        <option value="Tube">Tube</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner un type</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Section</label>
                                    <input type="text" class="form-control" name="chemin_cable_section" required>
                                    <div class="invalid-feedback">Veuillez entrer une section</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Profondeur (cm)</label>
                                    <input type="number" class="form-control" name="chemin_cable_profondeur" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer une profondeur valide</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_chemincable" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
                        <!-- Ground Tab -->
            <div class="tab-pane fade" id="terre" role="tabpanel" aria-labelledby="terre-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi de la Mise à la Terre</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="terre">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:46:43">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Longueur (mètres)</label>
                                    <input type="number" class="form-control" name="terre_longueur" required step="0.1" min="0">
                                    <div class="invalid-feedback">Veuillez entrer une longueur valide</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_terre" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- AC Cable Tab -->
            <div class="tab-pane fade" id="cable-ac" role="tabpanel" aria-labelledby="cable-ac-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi des Câbles AC</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="cable_ac">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:46:43">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Section (mm²)</label>
                                    <input type="number" class="form-control" name="cableac_section" required step="0.1" min="0">
                                    <div class="invalid-feedback">Veuillez entrer une section valide</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Longueur (mètres)</label>
                                    <input type="number" class="form-control" name="cableac_longueur" required step="0.1" min="0">
                                    <div class="invalid-feedback">Veuillez entrer une longueur valide</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_cableac" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- DC Cable Tab -->
            <div class="tab-pane fade" id="cable-dc" role="tabpanel" aria-labelledby="cable-dc-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi des Câbles DC</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="cable_dc">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:46:43">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Section (mm²)</label>
                                    <input type="number" class="form-control" name="cabledc_section" required step="0.1" min="0">
                                    <div class="invalid-feedback">Veuillez entrer une section valide</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Longueur (mètres)</label>
                                    <input type="number" class="form-control" name="cabledc_longueur" required step="0.1" min="0">
                                    <div class="invalid-feedback">Veuillez entrer une longueur valide</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_cabledc" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
                        <!-- Progress Tab -->
            <div class="tab-pane fade" id="avancement" role="tabpanel" aria-labelledby="avancement-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi de l'Avancement</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="avancement">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:47:55">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label class="form-label">Câbles DC Tirés</label>
                                    <input type="number" class="form-control" name="cables_dctires" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Câbles AC Tirés</label>
                                    <input type="number" class="form-control" name="cables_actires" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Câbles Terre Tirés</label>
                                    <input type="number" class="form-control" name="cables_terretires" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Problèmes Rencontrés</label>
                                    <textarea class="form-control" name="problems" rows="3"></textarea>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Conditions Météo</label>
                                    <select class="form-select" name="weather_conditions" required>
                                        <option value="">Sélectionner</option>
                                        <option value="Ensoleillé">Ensoleillé</option>
                                        <option value="Nuageux">Nuageux</option>
                                        <option value="Pluvieux">Pluvieux</option>
                                        <option value="Venteux">Venteux</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner les conditions météo</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Température (°C)</label>
                                    <input type="number" class="form-control" name="temperature" required>
                                    <div class="invalid-feedback">Veuillez entrer la température</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Heures de Travail</label>
                                    <input type="number" class="form-control" name="work_hours" required step="0.5" min="0">
                                    <div class="invalid-feedback">Veuillez entrer les heures de travail</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Nombre de Personnel</label>
                                    <input type="number" class="form-control" name="staff_count" required min="1">
                                    <div class="invalid-feedback">Veuillez entrer le nombre de personnel</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_avancement" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
                        <!-- Progress Tab -->
            <div class="tab-pane fade" id="avancement" role="tabpanel" aria-labelledby="avancement-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Suivi de l'Avancement</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="avancement">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:47:55">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label class="form-label">Câbles DC Tirés</label>
                                    <input type="number" class="form-control" name="cables_dctires" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Câbles AC Tirés</label>
                                    <input type="number" class="form-control" name="cables_actires" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Câbles Terre Tirés</label>
                                    <input type="number" class="form-control" name="cables_terretires" required min="0">
                                    <div class="invalid-feedback">Veuillez entrer un nombre valide</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Problèmes Rencontrés</label>
                                    <textarea class="form-control" name="problems" rows="3"></textarea>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">Conditions Météo</label>
                                    <select class="form-select" name="weather_conditions" required>
                                        <option value="">Sélectionner</option>
                                        <option value="Ensoleillé">Ensoleillé</option>
                                        <option value="Nuageux">Nuageux</option>
                                        <option value="Pluvieux">Pluvieux</option>
                                        <option value="Venteux">Venteux</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner les conditions météo</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Température (°C)</label>
                                    <input type="number" class="form-control" name="temperature" required>
                                    <div class="invalid-feedback">Veuillez entrer la température</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Heures de Travail</label>
                                    <input type="number" class="form-control" name="work_hours" required step="0.5" min="0">
                                    <div class="invalid-feedback">Veuillez entrer les heures de travail</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Nombre de Personnel</label>
                                    <input type="number" class="form-control" name="staff_count" required min="1">
                                    <div class="invalid-feedback">Veuillez entrer le nombre de personnel</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_avancement" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
                        <!-- End Tab -->
            <div class="tab-pane fade" id="fin" role="tabpanel" aria-labelledby="fin-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="card-title mb-4">Tableau des Tensions Finales</div>
                        <form method="POST" action="{{ url_for('suivi_journalier') }}" class="needs-validation" novalidate>
                            <input type="hidden" name="section" value="fin">
                            <input type="hidden" name="last_modified" value="2025-06-03 14:49:15">
                            <input type="hidden" name="last_modified_by" value="tsbenergie">
                            
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Zone</label>
                                    <input type="text" class="form-control" name="fin_zone" required>
                                    <div class="invalid-feedback">Veuillez entrer la zone</div>
                                </div>
                                
                                <div class="col-md-6">
                                    <label class="form-label">String</label>
                                    <input type="text" class="form-control" name="fin_string" required>
                                    <div class="invalid-feedback">Veuillez entrer le string</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Tension DC (V)</label>
                                    <input type="number" class="form-control" name="fin_tension_dc" required step="0.1">
                                    <div class="invalid-feedback">Veuillez entrer la tension DC</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Courant DC (A)</label>
                                    <input type="number" class="form-control" name="fin_courant_dc" required step="0.01">
                                    <div class="invalid-feedback">Veuillez entrer le courant DC</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Tension AC (V)</label>
                                    <input type="number" class="form-control" name="fin_tension_ac" required step="0.1">
                                    <div class="invalid-feedback">Veuillez entrer la tension AC</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Puissance (W)</label>
                                    <input type="number" class="form-control" name="fin_puissance" required step="0.1">
                                    <div class="invalid-feedback">Veuillez entrer la puissance</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Date de Mesure</label>
                                    <input type="datetime-local" class="form-control" name="fin_date" required>
                                    <div class="invalid-feedback">Veuillez entrer la date de mesure</div>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Technicien</label>
                                    <input type="text" class="form-control" name="fin_technicien" required>
                                    <div class="invalid-feedback">Veuillez entrer le nom du technicien</div>
                                </div>
                                
                                <div class="col-md-12">
                                    <label class="form-label">Status</label>
                                    <select class="form-select" name="fin_status" required>
                                        <option value="">Sélectionner un status</option>
                                        <option value="Conforme">Conforme</option>
                                        <option value="Non Conforme">Non Conforme</option>
                                        <option value="À Vérifier">À Vérifier</option>
                                    </select>
                                    <div class="invalid-feedback">Veuillez sélectionner un status</div>
                                </div>
                                
                                <div class="col-12">
                                    <label class="form-label">Photos</label>
                                    <input type="file" class="form-control" name="photo_fin" multiple accept="image/*">
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                                <button type="reset" class="btn btn-secondary">Réinitialiser</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>*
                        <!-- History Tab -->
            <div class="tab-pane fade" id="historique" role="tabpanel" aria-labelledby="historique-tab">
                <div class="card rounded-card mb-3">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <div class="card-title mb-0">Historique Complet des Entrées</div>
                            <!-- Search and Filter -->
                            <div class="d-flex gap-2">
                                <input type="text" class="form-control" id="searchHistory" 
                                       placeholder="Rechercher...">
                                <select class="form-select" id="filterHistory">
                                    <option value="">Toutes les sections</option>
                                    <option value="equipement">Équipement</option>
                                    <option value="connecteur">Connecteur</option>
                                    <option value="chemincable">Chemin de câble</option>
                                    <option value="terre">Terre</option>
                                    <option value="cable_ac">Câble AC</option>
                                    <option value="cable_dc">Câble DC</option>
                                    <option value="avancement">Avancement</option>
                                    <option value="fin">Tensions Finales</option>
                                </select>
                            </div>
                        </div>

                        <!-- Export Buttons -->
                        <div class="mb-3">
                            <button type="button" class="btn btn-primary" onclick="exportToCSV()">
                                <i class="fas fa-file-csv"></i> Télécharger CSV
                            </button>
                            <button type="button" class="btn btn-danger" onclick="exportToPDF()">
                                <i class="fas fa-file-pdf"></i> Télécharger PDF
                            </button>
                        </div>

                        <!-- Date Range Filter -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label class="form-label">Date Début</label>
                                <input type="date" class="form-control" id="startDate">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Date Fin</label>
                                <input type="date" class="form-control" id="endDate">
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button class="btn btn-secondary" onclick="filterByDate()">
                                    Filtrer
                                </button>
                            </div>
                        </div>

                        <!-- Complete History Table -->
                        <div class="table-responsive">
                            <table class="table table-striped table-hover" id="historyTable">
                                <thead class="table-primary">
                                    <tr>
                                        <!-- Common Fields -->
                                        <th>Date</th>
                                        <th>Utilisateur</th>
                                        <th>Section</th>
                                        
                                        <!-- Equipment Fields -->
                                        <th>Type Machine</th>
                                        <th>Référence</th>
                                        <th>État</th>
                                        <th>Date Réception</th>
                                        <th>Nombre</th>
                                        
                                        <!-- Connector Fields -->
                                        <th>Type Connecteur</th>
                                        <th>Quantité</th>
                                        <th>État Connecteur</th>
                                        
                                        <!-- Cable Path Fields -->
                                        <th>Longueur Chemin</th>
                                        <th>Type Chemin</th>
                                        <th>Section Chemin</th>
                                        <th>Profondeur</th>
                                        
                                        <!-- Ground Fields -->
                                        <th>Longueur Terre</th>
                                        
                                        <!-- AC Cable Fields -->
                                        <th>Section AC</th>
                                        <th>Longueur AC</th>
                                        
                                        <!-- DC Cable Fields -->
                                        <th>Section DC</th>
                                        <th>Longueur DC</th>
                                        
                                        <!-- Progress Fields -->
                                        <th>Câbles DC Tirés</th>
                                        <th>Câbles AC Tirés</th>
                                        <th>Câbles Terre Tirés</th>
                                        <th>Problèmes</th>
                                        <th>Météo</th>
                                        <th>Température</th>
                                        <th>Heures Travail</th>
                                        <th>Personnel</th>
                                        
                                        <!-- Final Tensions Fields -->
                                        <th>Zone</th>
                                        <th>String</th>
                                        <th>Tension DC (V)</th>
                                        <th>Courant DC (A)</th>
                                        <th>Tension AC (V)</th>
                                        <th>Puissance (W)</th>
                                        <th>Date Mesure</th>
                                        <th>Technicien</th>
                                        <th>Status</th>
                                        
                                        <!-- Actions -->
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if entries %}
                                        {% for entry in entries %}
                                        <tr data-entry-id="{{ entry.id }}">
                                            <td>{{ entry.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                                            <td>{{ entry.user }}</td>
                                            <td>{{ entry.section }}</td>
                                            
                                            <!-- Equipment Fields -->
                                            <td>{{ entry.equipement_type or '' }}</td>
                                            <td>{{ entry.equipement_reference or '' }}</td>
                                            <td>{{ entry.equipement_etat or '' }}</td>
                                            <td>{{ entry.equipement_date_reception or '' }}</td>
                                            <td>{{ entry.equipement_nombre or '' }}</td>
                                            
                                            <!-- Connector Fields -->
                                            <td>{{ entry.connecteur_type or '' }}</td>
                                            <td>{{ entry.connecteur_quantite or '' }}</td>
                                            <td>{{ entry.connecteur_etat or '' }}</td>
                                            
                                            <!-- Cable Path Fields -->
                                            <td>{{ entry.chemin_cable_longueur or '' }}</td>
                                            <td>{{ entry.chemin_cable_type or '' }}</td>
                                            <td>{{ entry.chemin_cable_section or '' }}</td>
                                            <td>{{ entry.chemin_cable_profondeur or '' }}</td>
                                            
                                            <!-- Ground Fields -->
                                            <td>{{ entry.terre_longueur or '' }}</td>
                                            
                                            <!-- AC Cable Fields -->
                                            <td>{{ entry.cableac_section or '' }}</td>
                                            <td>{{ entry.cableac_longueur or '' }}</td>
                                            
                                            <!-- DC Cable Fields -->
                                            <td>{{ entry.cabledc_section or '' }}</td>
                                            <td>{{ entry.cabledc_longueur or '' }}</td>
                                            
                                            <!-- Progress Fields -->
                                            <td>{{ entry.cables_dctires or '' }}</td>
                                            <td>{{ entry.cables_actires or '' }}</td>
                                            <td>{{ entry.cables_terretires or '' }}</td>
                                            <td>{{ entry.problems or '' }}</td>
                                            <td>{{ entry.weather_conditions or '' }}</td>
                                            <td>{{ entry.temperature or '' }}</td>
                                            <td>{{ entry.work_hours or '' }}</td>
                                            <td>{{ entry.staff_count or '' }}</td>
                                            
                                            <!-- Final Tensions Fields -->
                                            <td>{{ entry.fin_zone or '' }}</td>
                                            <td>{{ entry.fin_string or '' }}</td>
                                            <td>{{ entry.fin_tension_dc or '' }}</td>
                                            <td>{{ entry.fin_courant_dc or '' }}</td>
                                            <td>{{ entry.fin_tension_ac or '' }}</td>
                                            <td>{{ entry.fin_puissance or '' }}</td>
                                            <td>{{ entry.fin_date or '' }}</td>
                                            <td>{{ entry.fin_technicien or '' }}</td>
                                            <td>{{ entry.fin_status or '' }}</td>
                                            
                                            <!-- Actions -->
                                            <td>
                                                <div class="btn-group">
                                                    <button type="button" class="btn btn-sm btn-warning" 
                                                            onclick="editEntry({{ entry.id }})">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-sm btn-danger" 
                                                            onclick="deleteEntry({{ entry.id }})">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                    {% if entry.images %}
                                                    <button type="button" class="btn btn-sm btn-info" 
                                                            onclick="viewImages({{ entry.id }})">
                                                        <i class="fas fa-images"></i>
                                                    </button>
                                                    {% endif %}
                                                </div>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    {% else %}
                                        <tr>
                                            <td colspan="40" class="text-center">Aucune donnée disponible</td>
                                        </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>

                        <!-- Horizontal Scroll Hint -->
                        <div class="text-muted mt-2">
                            <small><i class="fas fa-info-circle"></i> Faites défiler horizontalement pour voir toutes les colonnes</small>
                        </div>

                        <!-- Pagination -->
                        {% if total_pages > 1 %}
                        <nav aria-label="Page navigation" class="mt-3">
                            <ul class="pagination justify-content-center">
                                <li class="page-item {{ 'disabled' if current_page == 1 }}">
                                    <a class="page-link" href="?page={{ current_page - 1 if current_page > 1 else 1 }}">Précédent</a>
                                </li>
                                {% for page in range(1, total_pages + 1) %}
                                <li class="page-item {{ 'active' if page == current_page }}">
                                    <a class="page-link" href="?page={{ page }}">{{ page }}</a>
                                </li>
                                {% endfor %}
                                <li class="page-item {{ 'disabled' if current_page == total_pages }}">
                                    <a class="page-link" href="?page={{ current_page + 1 if current_page < total_pages else total_pages }}">Suivant</a>
                                </li>
                            </ul>
                        </nav>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Closing div for tab-content -->
    </div>

    <!-- JavaScript for Bootstrap and Custom Functions -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Form validation
        (function() {
            'use strict';
            var forms = document.querySelectorAll('.needs-validation');
            Array.prototype.slice.call(forms).forEach(function(form) {
                form.addEventListener('submit', function(event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();

        // History table search and filter functions
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchHistory');
            const filterSelect = document.getElementById('filterHistory');
            const historyTable = document.getElementById('historyTable');

            function filterTable() {
                const searchTerm = searchInput.value.toLowerCase();
                const filterValue = filterSelect.value.toLowerCase();
                const rows = historyTable.getElementsByTagName('tr');

                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i];
                    const cells = row.getElementsByTagName('td');
                    if (cells.length > 0) {
                        let showRow = true;
                        const section = cells[2].textContent.toLowerCase();

                        // Apply section filter
                        if (filterValue && section !== filterValue) {
                            showRow = false;
                        }

                        // Apply search filter
                        if (showRow && searchTerm) {
                            showRow = false;
                            for (let cell of cells) {
                                if (cell.textContent.toLowerCase().includes(searchTerm)) {
                                    showRow = true;
                                    break;
                                }
                            }
                        }

                        row.style.display = showRow ? '' : 'none';
                    }
                }
            }

            if (searchInput && filterSelect) {
                searchInput.addEventListener('input', filterTable);
                filterSelect.addEventListener('change', filterTable);
            }
        });

        // Export functions
        function exportToCSV() {
            window.location.href = '/export/history/csv';
        }

        function exportToPDF() {
            window.location.href = '/export/history/pdf';
        }

        // Entry management functions
        function editEntry(entryId) {
            window.location.href = `/edit/history/${entryId}`;
        }

        function deleteEntry(entryId) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cette entrée?')) {
                fetch(`/delete/history/${entryId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': document.querySelector('[name=csrf-token]').content
                    }
                })
                .then(response => {
                    if (response.ok) {
                        const row = document.querySelector(`tr[data-entry-id="${entryId}"]`);
                        if (row) row.remove();
                    } else {
                        alert('Erreur lors de la suppression');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Erreur lors de la suppression');
                });
            }
        }

        function viewImages(entryId) {
            window.location.href = `/view/images/${entryId}`;
        }

        // Date filter function
        function filterByDate() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            if (startDate && endDate) {
                window.location.href = `?start=${startDate}&end=${endDate}`;
            }
        }
    </script>
</body>
</html>
